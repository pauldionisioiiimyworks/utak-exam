{"ast":null,"code":"/**\n * @typedef {import('..').FirebaseFirestoreTypes.DocumentReference} DocumentReference\n * @typedef {import('..').FirebaseFirestoreTypes.DocumentSnapshot} DocumentSnapshot\n * @typedef {import('..').FirebaseFirestoreTypes.FieldPath} FieldPath\n * @typedef {import('..').FirebaseFirestoreTypes.QueryCompositeFilterConstraint} QueryCompositeFilterConstraint\n * @typedef {import('..').FirebaseFirestoreTypes.QuerySnapshot} QuerySnapshot\n * @typedef {import('..').FirebaseFirestoreTypes.Query} Query\n * @typedef {import('..').FirebaseFirestoreTypes.WhereFilterOp} WhereFilterOp\n * @typedef {import('../FirestoreFilter')._Filter} _Filter\n * @typedef {import('./query').IQueryConstraint} IQueryConstraint\n * @typedef {import('./query').OrderByDirection} OrderByDirection\n * @typedef {import('./query').QueryFieldFilterConstraint} QueryFieldFilterConstraint\n * @typedef {import('./query').QueryLimitConstraint} QueryLimitConstraint\n * @typedef {import('./query').QueryNonFilterConstraint} QueryNonFilterConstraint\n * @typedef {import('./query').QueryOrderByConstraint} QueryOrderByConstraint\n * @typedef {import('./query').QueryStartAtConstraint} QueryStartAtConstraint\n */\n\nimport { _Filter, Filter } from '../FirestoreFilter';\n\n/**\n * @implements {IQueryConstraint}\n */\nclass QueryConstraint {\n  constructor(type, ...args) {\n    this.type = type;\n    this._args = args;\n  }\n  _apply(query) {\n    return query[this.type].apply(query, this._args);\n  }\n}\n\n/**\n * @param {Query} query\n * @param {QueryCompositeFilterConstraint | QueryConstraint | undefined} queryConstraint\n * @param {(QueryConstraint | QueryNonFilterConstraint)[]} additionalQueryConstraints\n * @returns {Query}\n */\nexport function query(query, queryConstraint, ...additionalQueryConstraints) {\n  const queryConstraints = [queryConstraint, ...additionalQueryConstraints].filter(constraint => constraint !== undefined);\n  let q = query;\n  for (const queryConstraint of queryConstraints) {\n    q = queryConstraint._apply(q);\n  }\n  return q;\n}\n\n/**\n * @param {string | FieldPath} fieldPath\n * @param {WhereFilterOp} opStr\n * @param {unknown} value\n * @returns {QueryFieldFilterConstraint}\n */\nexport function where(fieldPath, opStr, value) {\n  return new QueryConstraint('where', fieldPath, opStr, value);\n}\n\n/**\n * @param {QueryFieldFilterConstraint[]} queries\n * @returns {_Filter[]}\n */\nfunction getFilterOps(queries) {\n  const ops = [];\n  for (const query of queries) {\n    if (query.type !== 'where') {\n      throw 'Not where'; // FIXME: Better error message\n    }\n    const args = query._args;\n    if (!args.length) {\n      throw 'No args'; // FIXME: Better error message\n    }\n    if (args[0] instanceof _Filter) {\n      ops.push(args[0]);\n      continue;\n    }\n    const [fieldPath, opStr, value] = args;\n    ops.push(Filter(fieldPath, opStr, value));\n  }\n  return ops;\n}\n\n/**\n * @param {QueryFieldFilterConstraint[]} queries\n * @returns {QueryCompositeFilterConstraint}\n */\nexport function or(...queries) {\n  const ops = getFilterOps(queries);\n  return new QueryConstraint('where', Filter.or(...ops));\n}\n\n/**\n * @param {QueryFieldFilterConstraint[]} queries\n * @returns {QueryCompositeFilterConstraint}\n */\nexport function and(...queries) {\n  const ops = getFilterOps(queries);\n  return new QueryConstraint('where', Filter.and(...ops));\n}\n\n/**\n * @param {string | FieldPath} fieldPath\n * @param {OrderByDirection} directionStr\n * @returns {QueryOrderByConstraint}\n */\nexport function orderBy(fieldPath, directionStr) {\n  return new QueryConstraint('orderBy', fieldPath, directionStr);\n}\n\n/**\n * @param {(unknown | DocumentSnapshot)} docOrFields\n * @returns {QueryStartAtConstraint}\n */\nexport function startAt(...docOrFields) {\n  return new QueryConstraint('startAt', ...docOrFields);\n}\n\n/**\n * @param {(unknown | DocumentSnapshot)} docOrFields\n * @returns {QueryStartAtConstraint}\n */\nexport function startAfter(...docOrFields) {\n  return new QueryConstraint('startAfter', ...docOrFields);\n}\n\n/**\n * @param {number | string | boolean | null} value\n * @param {string?} key\n * @returns {QueryConstraint}\n */\nexport function endAt(value, key) {\n  if (!key) {\n    return new QueryConstraint('endAt', value);\n  }\n  return new QueryConstraint('endAt', value, key);\n}\n\n/**\n * @param {number | string | boolean | null} value\n * @param {string?} key\n * @returns {QueryConstraint}\n */\nexport function endBefore(value, key) {\n  if (!key) {\n    return new QueryConstraint('endBefore', value);\n  }\n  return new QueryConstraint('endBefore', value, key);\n}\n\n/**\n * @param {number} limit\n * @returns {QueryLimitConstraint}\n */\nexport function limit(limit) {\n  return new QueryConstraint('limit', limit);\n}\n\n/**\n * @param {number} limit\n * @returns {QueryConstraint}\n */\nexport function limitToLast(limit) {\n  return new QueryConstraint('limitToLast', limit);\n}\n\n/**\n * @param {Query} query\n * @returns {Promise<QuerySnapshot>}\n */\nexport function getDocs(query) {\n  return query.get({\n    source: 'default'\n  });\n}\n\n/**\n * @param {Query} query\n * @returns {Promise<QuerySnapshot>}\n */\nexport function getDocsFromCache(query) {\n  return query.get({\n    source: 'cache'\n  });\n}\n\n/**\n * @param {Query} query\n * @returns {Promise<QuerySnapshot>}\n */\nexport function getDocsFromServer(query) {\n  return query.get({\n    source: 'server'\n  });\n}\n\n/**\n * @param {DocumentReference} reference\n * @returns {Promise<void>}\n */\nexport function deleteDoc(reference) {\n  return reference.delete();\n}","map":{"version":3,"names":["_Filter","Filter","QueryConstraint","constructor","type","args","_args","_apply","query","apply","queryConstraint","additionalQueryConstraints","queryConstraints","filter","constraint","undefined","q","where","fieldPath","opStr","value","getFilterOps","queries","ops","length","push","or","and","orderBy","directionStr","startAt","docOrFields","startAfter","endAt","key","endBefore","limit","limitToLast","getDocs","get","source","getDocsFromCache","getDocsFromServer","deleteDoc","reference","delete"],"sources":["/Users/pauldionisio/Documents/CS/utak/utak-exam-app/node_modules/@react-native-firebase/firestore/lib/modular/query.js"],"sourcesContent":["/**\n * @typedef {import('..').FirebaseFirestoreTypes.DocumentReference} DocumentReference\n * @typedef {import('..').FirebaseFirestoreTypes.DocumentSnapshot} DocumentSnapshot\n * @typedef {import('..').FirebaseFirestoreTypes.FieldPath} FieldPath\n * @typedef {import('..').FirebaseFirestoreTypes.QueryCompositeFilterConstraint} QueryCompositeFilterConstraint\n * @typedef {import('..').FirebaseFirestoreTypes.QuerySnapshot} QuerySnapshot\n * @typedef {import('..').FirebaseFirestoreTypes.Query} Query\n * @typedef {import('..').FirebaseFirestoreTypes.WhereFilterOp} WhereFilterOp\n * @typedef {import('../FirestoreFilter')._Filter} _Filter\n * @typedef {import('./query').IQueryConstraint} IQueryConstraint\n * @typedef {import('./query').OrderByDirection} OrderByDirection\n * @typedef {import('./query').QueryFieldFilterConstraint} QueryFieldFilterConstraint\n * @typedef {import('./query').QueryLimitConstraint} QueryLimitConstraint\n * @typedef {import('./query').QueryNonFilterConstraint} QueryNonFilterConstraint\n * @typedef {import('./query').QueryOrderByConstraint} QueryOrderByConstraint\n * @typedef {import('./query').QueryStartAtConstraint} QueryStartAtConstraint\n */\n\nimport { _Filter, Filter } from '../FirestoreFilter';\n\n/**\n * @implements {IQueryConstraint}\n */\nclass QueryConstraint {\n  constructor(type, ...args) {\n    this.type = type;\n    this._args = args;\n  }\n\n  _apply(query) {\n    return query[this.type].apply(query, this._args);\n  }\n}\n\n/**\n * @param {Query} query\n * @param {QueryCompositeFilterConstraint | QueryConstraint | undefined} queryConstraint\n * @param {(QueryConstraint | QueryNonFilterConstraint)[]} additionalQueryConstraints\n * @returns {Query}\n */\nexport function query(query, queryConstraint, ...additionalQueryConstraints) {\n  const queryConstraints = [queryConstraint, ...additionalQueryConstraints].filter(\n    constraint => constraint !== undefined,\n  );\n  let q = query;\n  for (const queryConstraint of queryConstraints) {\n    q = queryConstraint._apply(q);\n  }\n  return q;\n}\n\n/**\n * @param {string | FieldPath} fieldPath\n * @param {WhereFilterOp} opStr\n * @param {unknown} value\n * @returns {QueryFieldFilterConstraint}\n */\nexport function where(fieldPath, opStr, value) {\n  return new QueryConstraint('where', fieldPath, opStr, value);\n}\n\n/**\n * @param {QueryFieldFilterConstraint[]} queries\n * @returns {_Filter[]}\n */\nfunction getFilterOps(queries) {\n  const ops = [];\n  for (const query of queries) {\n    if (query.type !== 'where') {\n      throw 'Not where'; // FIXME: Better error message\n    }\n\n    const args = query._args;\n    if (!args.length) {\n      throw 'No args'; // FIXME: Better error message\n    }\n\n    if (args[0] instanceof _Filter) {\n      ops.push(args[0]);\n      continue;\n    }\n\n    const [fieldPath, opStr, value] = args;\n    ops.push(Filter(fieldPath, opStr, value));\n  }\n  return ops;\n}\n\n/**\n * @param {QueryFieldFilterConstraint[]} queries\n * @returns {QueryCompositeFilterConstraint}\n */\nexport function or(...queries) {\n  const ops = getFilterOps(queries);\n  return new QueryConstraint('where', Filter.or(...ops));\n}\n\n/**\n * @param {QueryFieldFilterConstraint[]} queries\n * @returns {QueryCompositeFilterConstraint}\n */\nexport function and(...queries) {\n  const ops = getFilterOps(queries);\n  return new QueryConstraint('where', Filter.and(...ops));\n}\n\n/**\n * @param {string | FieldPath} fieldPath\n * @param {OrderByDirection} directionStr\n * @returns {QueryOrderByConstraint}\n */\nexport function orderBy(fieldPath, directionStr) {\n  return new QueryConstraint('orderBy', fieldPath, directionStr);\n}\n\n/**\n * @param {(unknown | DocumentSnapshot)} docOrFields\n * @returns {QueryStartAtConstraint}\n */\nexport function startAt(...docOrFields) {\n  return new QueryConstraint('startAt', ...docOrFields);\n}\n\n/**\n * @param {(unknown | DocumentSnapshot)} docOrFields\n * @returns {QueryStartAtConstraint}\n */\nexport function startAfter(...docOrFields) {\n  return new QueryConstraint('startAfter', ...docOrFields);\n}\n\n/**\n * @param {number | string | boolean | null} value\n * @param {string?} key\n * @returns {QueryConstraint}\n */\nexport function endAt(value, key) {\n  if (!key) {\n    return new QueryConstraint('endAt', value);\n  }\n  return new QueryConstraint('endAt', value, key);\n}\n\n/**\n * @param {number | string | boolean | null} value\n * @param {string?} key\n * @returns {QueryConstraint}\n */\nexport function endBefore(value, key) {\n  if (!key) {\n    return new QueryConstraint('endBefore', value);\n  }\n  return new QueryConstraint('endBefore', value, key);\n}\n\n/**\n * @param {number} limit\n * @returns {QueryLimitConstraint}\n */\nexport function limit(limit) {\n  return new QueryConstraint('limit', limit);\n}\n\n/**\n * @param {number} limit\n * @returns {QueryConstraint}\n */\nexport function limitToLast(limit) {\n  return new QueryConstraint('limitToLast', limit);\n}\n\n/**\n * @param {Query} query\n * @returns {Promise<QuerySnapshot>}\n */\nexport function getDocs(query) {\n  return query.get({ source: 'default' });\n}\n\n/**\n * @param {Query} query\n * @returns {Promise<QuerySnapshot>}\n */\nexport function getDocsFromCache(query) {\n  return query.get({ source: 'cache' });\n}\n\n/**\n * @param {Query} query\n * @returns {Promise<QuerySnapshot>}\n */\nexport function getDocsFromServer(query) {\n  return query.get({ source: 'server' });\n}\n\n/**\n * @param {DocumentReference} reference\n * @returns {Promise<void>}\n */\nexport function deleteDoc(reference) {\n  return reference.delete();\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}